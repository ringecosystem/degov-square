{{define "title"}} {{.Title}} {{end}}

{{define "header"}}
  {{$theme := "dark"}}
  {{if eq .DegovSiteConfig.EmailTheme "light"}}
    {{$theme = "light"}}
  {{end}}

  {{if eq $theme "dark"}}
  <style></style>
  {{else}}
  <style></style>
  {{end}}
{{end}}

{{define "content"}}
  {{$proposalDb := .Proposal.ProposalDb}}
  {{$proposalIndexer := .Proposal.ProposalIndexer}}
  {{$dao := .Dao}}
  {{$vote := .Vote}}
  {{$payload := .PayloadData}}

  <p style="margin: 0 0 16px; font-size: 16px; line-height: 1.6;">
    Hello {{if .EnsName}}{{.EnsName}}{{else}}{{.UserAddress}}{{end}},
  </p>
  <p style="margin: 0 0 20px; font-size: 16px; line-height: 1.6;">
    This is a friendly reminder that voting for the proposal <strong>"{{$proposalDb.Title}}"</strong> in {{$dao.Name}} is ending soon.
  </p>

  <table role="presentation" cellspacing="0" cellpadding="0" border="0" width="100%" style="font-size: 15px; line-height: 1.6; margin-bottom: 20px;">
    <tr>
      <td style="padding: 4px 0; width: 130px; vertical-align: top;"><strong>Proposal:</strong></td>
      <td style="padding: 4px 0;"><a href="{{$proposalDb.ProposalLink}}" target="_blank" style="color: #55acee; text-decoration: underline;">{{$proposalDb.Title}}</a></td>
    </tr>
    <tr>
      <td style="padding: 4px 0; vertical-align: top;"><strong>Voting Ends:</strong></td>
      <td style="padding: 4px 0;">{{$proposalIndexer.VoteEndTimestamp | formatDate}} {{if $payload.TimeRemaining}}({{$payload.TimeRemaining}} remaining){{end}}</td>
    </tr>
    {{if $vote.VoteIndexer}}
    <tr>
      <td style="padding: 4px 0; vertical-align: top;"><strong>Your Voting Power:</strong></td>
      <td style="padding: 4px 0;">{{(formatBigIntWithDecimals $vote.VoteIndexer.Weight $payload.DecimalsInt) | formatLargeNumber}}</td>
    </tr>
    {{end}}
  </table>

  <div class="divider" style="margin-top: 24px; margin-left: 0; margin-right: 0;"></div>

  <h3 style="margin: 24px 0 10px; font-size: 20px; font-weight: 600;">üìä Voting Progress ({{(formatBigIntWithDecimals $vote.TotalVotePower $payload.DecimalsInt) | formatLargeNumber}} / {{(formatBigIntWithDecimals $proposalIndexer.Quorum $payload.DecimalsInt) | formatLargeNumber}})</h3>
  <table role="presentation" cellspacing="0" cellpadding="0" border="0" width="100%" style="font-size: 15px; line-height: 1.6;">
    <tr>
      <td style="padding: 4px 0;">‚úÖ&nbsp; <strong>For:</strong></td>
      <td style="padding: 4px 0; text-align: right;">
        {{if $proposalIndexer}}
        {{(formatBigIntWithDecimals $proposalIndexer.MetricsVotesWeightForSum $payload.DecimalsInt) | formatLargeNumber}} ({{$vote.PercentFor | formatPercent}})
        {{else}}
        N/A
        {{end}}
      </td>
    </tr>
    <tr>
      <td style="padding: 4px 0;">‚ùå&nbsp; <strong>Against:</strong></td>
      <td style="padding: 4px 0; text-align: right;">
        {{if $proposalIndexer}}
        {{(formatBigIntWithDecimals $proposalIndexer.MetricsVotesWeightAgainstSum $payload.DecimalsInt) | formatLargeNumber}} ({{$vote.PercentAgainst | formatPercent}})
        {{else}}
        N/A
        {{end}}
      </td>
    </tr>
    <tr>
      <td style="padding: 4px 0;">‚ö™Ô∏è&nbsp; <strong>Abstain:</strong></td>
      <td style="padding: 4px 0; text-align: right;">
        {{if $proposalIndexer}}
        {{(formatBigIntWithDecimals $proposalIndexer.MetricsVotesWeightAbstainSum $payload.DecimalsInt) | formatLargeNumber}} ({{$vote.PercentAbstain | formatPercent}})
        {{else}}
        N/A
        {{end}}
      </td>
    </tr>
  </table>

  <div class="divider" style="margin-top: 24px; margin-left: 0; margin-right: 0;"></div>

  <h3 style="margin: 24px 0 10px; font-size: 20px; font-weight: 600;">Quorum Progress</h3>
  <p style="margin: 0; font-size: 16px; line-height: 1.6;">
    {{if ge $vote.PercentQuorum 100.0}}
      <strong>{{$vote.PercentQuorum | formatPercent}}</strong> ‚úÖ (Threshold exceeded!)
    {{else}}
      <strong>{{$vote.PercentQuorum | formatPercent}}</strong> ‚ö†Ô∏è (Needs more votes!)
    {{end}}
  </p>

  <p style="margin: 24px 0 16px; font-size: 16px; line-height: 1.6;">
    Every vote counts in decentralized governance. Make your voice heard!
  </p>
  <table role="presentation" cellspacing="0" cellpadding="0" border="0" width="100%" style="margin-bottom: 20px;">
    <tr>
      <td>
        <a href="{{$proposalDb.ProposalLink}}" target="_blank" style="color: #55acee; text-decoration: underline; font-size: 15px; font-weight: 600;">
          Cast Your Vote Now &rarr;
        </a>
      </td>
    </tr>
  </table>

  <p style="margin: 0; font-size: 16px; line-height: 1.6;">
    Best regards,<br />
    The {{.DegovSiteConfig.Name}} Team
  </p>
{{end}}
